!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("domql",[],r):"object"==typeof exports?exports.domql=r():t.domql=r()}("undefined"!=typeof self?self:this,function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var u=r[n]={i:n,l:!1,exports:{}};return t[n].call(u.exports,u,u.exports,e),u.l=!0,u.exports}return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var u in t)e.d(n,u,function(r){return t[r]}.bind(null,u));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=0)}([function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Domql=void 0;var n=e(1),u=e(3),o=function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,e):{};n.get||n.set?Object.defineProperty(r,e,n):r[e]=t[e]}return r.default=t,r}(e(4));function i(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this._name="Domql",this.compile(r)}var r,e,a;return r=t,(e=[{key:"compile",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this._query=t,t){var r=(0,n.parse)(t);this._directives=(0,u.transpile)(r)}}},{key:"execute",value:function(){return o.execute(this._directives)}},{key:"name",get:function(){return this._name}},{key:"query",get:function(){return this._query}}])&&i(r.prototype,e),a&&i(r,a),t}();r.Domql=a},function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parse=function(t){return(0,n.parse)(t)};var n=e(2)},function(t,r,e){"use strict";function n(t,r,e,u){this.message=t,this.expected=r,this.found=e,this.location=u,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}function u(t,r){r=void 0!==r?r:{};var e,u={},o={start:Pe},i=Pe,a="!",c="=",f=">=",s=">",l="<=",p="<>",v="<",h="!=",d='"',b="'",y="`",g="*",A="\\'",m='\\"',C="\\\\",x="\\/",w="\\b",O="\\f",E="\\n",_="\\r",S="\\t",L="\\u",R=".",j="null",F="true",T="false",D="select",N="from",I="where",M="group",P="by",q="order",k="limit",U="asc",z="desc",Z="in",K="is",X="like",B="exists",G="not",H="and",W="or",Y=",",J="(",Q=")",V=/^[^"]/,$=/^[^']/,tt=/^[^`]/,rt=/^[A-Za-z_]/,et=/^[A-Za-z0-9_.]/,nt=/^[A-Za-z0-9_:]/,ut=/^[^'\\\0-\x1F\x7F]/,ot=/^[0-9]/,it=/^[0-9a-fA-F]/,at=/^[eE]/,ct=/^[+\-]/,ft=/^[ \t\n\r]/,st=Le("!",!1),lt=Le("=",!1),pt=Le(">=",!1),vt=Le(">",!1),ht=Le("<=",!1),dt=Le("<>",!1),bt=Le("<",!1),yt=Le("!=",!1),gt=Le('"',!1),At=Re(['"'],!0,!1),mt=Le("'",!1),Ct=Re(["'"],!0,!1),xt=Le("`",!1),wt=Re(["`"],!0,!1),Ot=Re([["A","Z"],["a","z"],"_"],!1,!1),Et=Re([["A","Z"],["a","z"],["0","9"],"_","."],!1,!1),_t=Re([["A","Z"],["a","z"],["0","9"],"_",":"],!1,!1),St=Re(["'","\\",["\0",""],""],!0,!1),Lt=Le("\\'",!1),Rt=Le('\\"',!1),jt=Le("\\\\",!1),Ft=Le("\\/",!1),Tt=Le("\\b",!1),Dt=Le("\\f",!1),Nt=Le("\\n",!1),It=Le("\\r",!1),Mt=Le("\\t",!1),Pt=Le("\\u",!1),qt=Le(".",!1),kt=Re([["0","9"]],!1,!1),Ut=Re([["0","9"],["a","f"],["A","F"]],!1,!1),zt=Re(["e","E"],!1,!1),Zt=Re(["+","-"],!1,!1),Kt=Le("NULL",!0),Xt=Le("TRUE",!0),Bt=Le("FALSE",!0),Gt=Le("SELECT",!0),Ht=Le("FROM",!0),Wt=Le("WHERE",!0),Yt=Le("GROUP",!0),Jt=Le("BY",!0),Qt=Le("ORDER",!0),Vt=Le("LIMIT",!0),$t=Le("ASC",!0),tr=Le("DESC",!0),rr=Le("IN",!0),er=Le("IS",!0),nr=Le("LIKE",!0),ur=Le("EXISTS",!0),or=Le("NOT",!0),ir=Le("AND",!0),ar=Le("OR",!0),cr=Le(",",!1),fr=Le("*",!1),sr=Le("(",!1),lr=Le(")",!1),pr=Re([" ","\t","\n","\r"],!1,!1),vr=function(t,r,e,n,u,o){return{type:"select",columns:t,from:r,where:e,groupby:n,orderby:u,limit:o}},hr=function(){return"*"},dr=function(t,r){return Tn(t,r)},br=function(t){return t},yr=function(t){return t},gr=function(t,r){return r.unshift(t),r},Ar=function(t){return t},mr=function(t){return{type:"table_ref",table:t}},Cr=function(t){return t},xr=function(t,r){var e=t;return e.order="ASC","DESC"===r&&(e.order="DESC"),e},wr=function(t){return t},Or=function(t,r){var e={type:"expr_list"};return e.value=Tn(t,r),e},Er=function(t,r){return Dn(t,r)},_r=function(t){return jn("NOT",t)},Sr=function(t,r){return null===r?t:"arithmetic"===r.type?Dn(t,r.tail):Fn(r.op,t,r.right)},Lr=function(t,r){return r.parentheses=!0,jn(t,r)},Rr=function(t){return t[0]+" "+t[2]},jr=function(t){return{type:"arithmetic",tail:t}},Fr=function(t){return{op:"IS",right:t}},Tr=function(t){return{op:"IS NOT",right:t}},Dr=function(t,r){return{op:t,right:r}},Nr=function(t,r){return{op:t,right:r}},Ir=function(t,r){return Dn(t,r)},Mr=function(t){return t.parentheses=!0,t},Pr=function(t){return t.parentheses=!0,t},qr=function(t,r){return{type:"column_ref",table:t,column:r}},kr=function(t){return{type:"column_ref",column:t}},Ur=function(){return"*"},zr=function(t){return!0===Rn[t.toUpperCase()]},Zr=function(t){return t},Kr=function(t){return t.join("")},Xr=function(t){return t},Br=function(t,r){return t+r.join("")},Gr=function(){return{type:"null",value:null}},Hr=function(){return{type:"bool",value:!0}},Wr=function(){return{type:"bool",value:!1}},Yr=function(t){return{type:"string",value:t[1].join("")}},Jr=function(){return"'"},Qr=function(){return'"'},Vr=function(){return"\\"},$r=function(){return"/"},te=function(){return"\b"},re=function(){return"\f"},ee=function(){return"\n"},ne=function(){return"\r"},ue=function(){return"\t"},oe=function(t,r,e,n){return String.fromCharCode(parseInt("0x"+t+r+e+n))},ie=function(t){return{type:"number",value:t}},ae=function(t,r,e){return parseFloat(t+r+e)},ce=function(t,r){return parseFloat(t+r)},fe=function(t,r){return parseFloat(t+r)},se=function(t){return parseFloat(t)},le=function(t){return"."+t},pe=function(t,r){return t+r},ve=function(t){return t.join("")},he=function(t,r){return t+(null!==r?r:"")},de=function(){return"ASC"},be=function(){return"DESC"},ye=function(){return"IN"},ge=function(){return"IS"},Ae=function(){return"LIKE"},me=function(){return"EXISTS"},Ce=function(){return"NOT"},xe=function(){return"AND"},we=function(){return"OR"},Oe=0,Ee=[{line:1,column:1}],_e=[],Se=0;if("startRule"in r){if(!(r.startRule in o))throw new Error("Can't start parsing from rule \""+r.startRule+'".');i=o[r.startRule]}function Le(t,r){return{type:"literal",text:t,ignoreCase:r}}function Re(t,r,e){return{type:"class",parts:t,inverted:r,ignoreCase:e}}function je(r){var e,n=Ee[r];if(n)return n;for(e=r-1;!Ee[e];)e--;for(n={line:(n=Ee[e]).line,column:n.column};e<r;)10===t.charCodeAt(e)?(n.line++,n.column=1):n.column++,e++;return Ee[r]=n,n}var Fe="string"==typeof r.filename&&r.filename.length>0;function Te(t,e){var n={};Fe&&(n.filename=r.filename);var u=je(t);n.start={offset:t,line:u.line,column:u.column};var o=je(e);return n.end={offset:e,line:o.line,column:o.column},n}function De(){_e.push({pos:Oe,variants:[]})}function Ne(t){var r=_e[_e.length-1];Oe<r.pos||(Oe>r.pos&&(r.pos=Oe,r.variants=[]),r.variants.push(t))}function Ie(t){var r=_e.pop(),e=_e[_e.length-1],n=r.variants;e.pos===r.pos&&(t&&(n=n.map(function(t){return"not"===t.type?t.expected:{type:"not",expected:t}})),Array.prototype.push.apply(e.variants,n))}function Me(t,r,e){return new n(n.buildMessage(t,r),t,r,e)}function Pe(){return qe()}function qe(){var r,e,n,o,i,a,c;return r=Oe,Sn(),function(){var r,e,n,o;r=Oe,i=Gt,0===Se&&Ne(i),t.substr(Oe,6).toLowerCase()===D?(e=t.substr(Oe,6),Oe+=6):e=u;var i;e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?r=e=[e,n]:(Oe=r,r=u)):(Oe=r,r=u);return r}()!==u?(Sn(),(e=function(){var t,r,e,n,o,i,a,c;t=Oe,r=Oe,(e=On())!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?r=e=[e,n]:(Oe=r,r=u)):(Oe=r,r=u);r!==u&&(t,r=hr());if((t=r)===u)if(t=Oe,(r=ke())!==u){for(e=[],n=Oe,o=Sn(),(i=wn())!==u?(a=Sn(),(c=ke())!==u?n=o=[o,i,a,c]:(Oe=n,n=u)):(Oe=n,n=u);n!==u;)e.push(n),n=Oe,o=Sn(),(i=wn())!==u?(a=Sn(),(c=ke())!==u?n=o=[o,i,a,c]:(Oe=n,n=u)):(Oe=n,n=u);t,t=dr(r,e)}else Oe=t,t=u;return t}())!==u?(Sn(),(n=function(){var r,e;r=Oe,function(){var r,e,n,o,i;return r=Oe,i=Ht,0===Se&&Ne(i),t.substr(Oe,4).toLowerCase()===N?(e=t.substr(Oe,4),Oe+=4):e=u,e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?r=e=[e,n]:(Oe=r,r=u)):(Oe=r,r=u),r}()!==u?(Sn(),(e=function(){var t,r,e,n;if(t=Oe,(r=ze())!==u){for(e=[],n=Ue();n!==u;)e.push(n),n=Ue();t,t=gr(r,e)}else Oe=t,t=u;return t}())!==u?(r,r=yr(e)):(Oe=r,r=u)):(Oe=r,r=u);return r}())===u&&(n=null),Sn(),(o=function(){var r,e;r=Oe,function(){var r,e,n,o,i;return r=Oe,i=Wt,0===Se&&Ne(i),t.substr(Oe,5).toLowerCase()===I?(e=t.substr(Oe,5),Oe+=5):e=u,e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?r=e=[e,n]:(Oe=r,r=u)):(Oe=r,r=u),r}()!==u?(Sn(),(e=Xe())!==u?(r,r=Cr(e)):(Oe=r,r=u)):(Oe=r,r=u);return r}())===u&&(o=null),Sn(),(i=function(){var r,e;r=Oe,function(){var r,e,n,o,i;return r=Oe,i=Yt,0===Se&&Ne(i),t.substr(Oe,5).toLowerCase()===M?(e=t.substr(Oe,5),Oe+=5):e=u,e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?r=e=[e,n]:(Oe=r,r=u)):(Oe=r,r=u),r}()!==u?(Sn(),dn()!==u?(Sn(),(e=function(){var t,r,e,n,o,i,a,c;if(t=Oe,(r=Ve())!==u){for(e=[],n=Oe,o=Sn(),(i=wn())!==u?(a=Sn(),(c=Ve())!==u?n=o=[o,i,a,c]:(Oe=n,n=u)):(Oe=n,n=u);n!==u;)e.push(n),n=Oe,o=Sn(),(i=wn())!==u?(a=Sn(),(c=Ve())!==u?n=o=[o,i,a,c]:(Oe=n,n=u)):(Oe=n,n=u);t,t=dr(r,e)}else Oe=t,t=u;return t}())!==u?(r,r=yr(e)):(Oe=r,r=u)):(Oe=r,r=u)):(Oe=r,r=u);return r}())===u&&(i=null),Sn(),(a=function(){var r,e;r=Oe,function(){var r,e,n,o,i;return r=Oe,i=Qt,0===Se&&Ne(i),t.substr(Oe,5).toLowerCase()===q?(e=t.substr(Oe,5),Oe+=5):e=u,e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?r=e=[e,n]:(Oe=r,r=u)):(Oe=r,r=u),r}()!==u?(Sn(),dn()!==u?(Sn(),(e=function(){var t,r,e,n,o,i,a,c;if(t=Oe,(r=Ze())!==u){for(e=[],n=Oe,o=Sn(),(i=wn())!==u?(a=Sn(),(c=Ze())!==u?n=o=[o,i,a,c]:(Oe=n,n=u)):(Oe=n,n=u);n!==u;)e.push(n),n=Oe,o=Sn(),(i=wn())!==u?(a=Sn(),(c=Ze())!==u?n=o=[o,i,a,c]:(Oe=n,n=u)):(Oe=n,n=u);t,t=dr(r,e)}else Oe=t,t=u;return t}())!==u?(r,r=yr(e)):(Oe=r,r=u)):(Oe=r,r=u)):(Oe=r,r=u);return r}())===u&&(a=null),Sn(),(c=function(){var r,e;r=Oe,function(){var r,e,n,o,i;return r=Oe,i=Vt,0===Se&&Ne(i),t.substr(Oe,5).toLowerCase()===k?(e=t.substr(Oe,5),Oe+=5):e=u,e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?r=e=[e,n]:(Oe=r,r=u)):(Oe=r,r=u),r}()!==u?(Sn(),(e=cn())!==u?(r,r=wr(e)):(Oe=r,r=u)):(Oe=r,r=u);return r}())===u&&(c=null),r,r=vr(e,n,o,i,a,c)):(Oe=r,r=u)):(Oe=r,r=u),r}function ke(){var t,r;return t=Oe,(r=Ve())!==u&&(t,r=br(r)),t=r}function Ue(){var t,r;return t=Oe,Sn(),wn()!==u?(Sn(),(r=ze())!==u?(t,t=Ar(r)):(Oe=t,t=u)):(Oe=t,t=u),t}function ze(){var t,r;return t=Oe,(r=$e())!==u&&(t,r=mr(r)),t=r}function Ze(){var r,e,n;return r=Oe,(e=Ve())!==u?(Sn(),(n=function(){var r,e,n,o;r=Oe,i=tr,0===Se&&Ne(i),t.substr(Oe,4).toLowerCase()===z?(e=t.substr(Oe,4),Oe+=4):e=u;var i;e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?(r,r=be()):(Oe=r,r=u)):(Oe=r,r=u);return r}())===u&&(n=function(){var r,e,n,o;r=Oe,i=$t,0===Se&&Ne(i),t.substr(Oe,3).toLowerCase()===U?(e=t.substr(Oe,3),Oe+=3):e=u;var i;e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?(r,r=de()):(Oe=r,r=u)):(Oe=r,r=u);return r}()),n===u&&(n=null),r,r=xr(e,n)):(Oe=r,r=u),r}function Ke(){var t,r,e,n,o,i,a,c;if(t=Oe,(r=Xe())!==u){for(e=[],n=Oe,o=Sn(),(i=wn())!==u?(a=Sn(),(c=Xe())!==u?n=o=[o,i,a,c]:(Oe=n,n=u)):(Oe=n,n=u);n!==u;)e.push(n),n=Oe,o=Sn(),(i=wn())!==u?(a=Sn(),(c=Xe())!==u?n=o=[o,i,a,c]:(Oe=n,n=u)):(Oe=n,n=u);t,t=Or(r,e)}else Oe=t,t=u;return t}function Xe(){var t,r,e,n,o,i,a,c;if(t=Oe,(r=Be())!==u){for(e=[],n=Oe,o=Sn(),(i=xn())!==u?(a=Sn(),(c=Be())!==u?n=o=[o,i,a,c]:(Oe=n,n=u)):(Oe=n,n=u);n!==u;)e.push(n),n=Oe,o=Sn(),(i=xn())!==u?(a=Sn(),(c=Be())!==u?n=o=[o,i,a,c]:(Oe=n,n=u)):(Oe=n,n=u);t,t=Er(r,e)}else Oe=t,t=u;return t}function Be(){var t,r,e,n,o,i,a,c;if(t=Oe,(r=Ge())!==u){for(e=[],n=Oe,o=Sn(),(i=Cn())!==u?(a=Sn(),(c=Ge())!==u?n=o=[o,i,a,c]:(Oe=n,n=u)):(Oe=n,n=u);n!==u;)e.push(n),n=Oe,o=Sn(),(i=Cn())!==u?(a=Sn(),(c=Ge())!==u?n=o=[o,i,a,c]:(Oe=n,n=u)):(Oe=n,n=u);t,t=Er(r,e)}else Oe=t,t=u;return t}function Ge(){var r,e,n,o,i,f=function(t){0===Se&&Ne(t)};return(r=He())===u&&(r=function(){var t,r,e;t=Oe,(r=function(){var t,r,e,n,o;return t=Oe,r=Oe,(e=mn())!==u?(n=Sn(),(o=An())!==u?r=e=[e,n,o]:(Oe=r,r=u)):(Oe=r,r=u),r!==u&&(t,r=Rr(r)),(t=r)===u&&(t=An()),t}())!==u?(Sn(),En()!==u?(Sn(),(e=qe())!==u?(Sn(),_n()!==u?(t,t=Lr(r,e)):(Oe=t,t=u)):(Oe=t,t=u)):(Oe=t,t=u)):(Oe=t,t=u);return t}())===u&&(r=Oe,(e=mn())===u&&(e=Oe,f(st),33===t.charCodeAt(Oe)?(n=a,Oe++):n=u,n!==u?(o=Oe,De(),f(lt),61===t.charCodeAt(Oe)?(i=c,Oe++):i=u,Ie(!0),i===u?o=void 0:(Oe=o,o=u),o!==u?e=n=[n,o]:(Oe=e,e=u)):(Oe=e,e=u)),e!==u?(n=Sn(),(o=Ge())!==u?(r,r=_r(o)):(Oe=r,r=u)):(Oe=r,r=u)),r}function He(){var t,r,e;return t=Oe,(r=Ye())!==u?(Sn(),(e=function(){var t;(t=function(){var t,r,e,n,o,i,a;if(t=Oe,r=[],e=Oe,n=Sn(),(o=We())!==u?(i=Sn(),(a=Ye())!==u?e=n=[n,o,i,a]:(Oe=e,e=u)):(Oe=e,e=u),e!==u)for(;e!==u;)r.push(e),e=Oe,n=Sn(),(o=We())!==u?(i=Sn(),(a=Ye())!==u?e=n=[n,o,i,a]:(Oe=e,e=u)):(Oe=e,e=u);else r=u;return r!==u&&(t,r=jr(r)),t=r}())===u&&(t=function(){var t,r,e;t=Oe,(r=function(){var t,r,e,n,o;return t=Oe,r=Oe,(e=mn())!==u?(n=Sn(),(o=bn())!==u?r=e=[e,n,o]:(Oe=r,r=u)):(Oe=r,r=u),r!==u&&(t,r=Rr(r)),(t=r)===u&&(t=bn()),t}())!==u?(Sn(),En()!==u?(Sn(),(e=Ke())!==u?(Sn(),_n()!==u?(t,t=Nr(r,e)):(Oe=t,t=u)):(Oe=t,t=u)):(Oe=t,t=u)):(Oe=t,t=u);return t}())===u&&(t=function(){var t,r,e,n,o;t=Oe,(r=yn())!==u?(e=Sn(),(n=Ye())!==u?(t,t=Fr(n)):(Oe=t,t=u)):(Oe=t,t=u);t===u&&(t=Oe,r=Oe,(e=yn())!==u?(n=Sn(),(o=mn())!==u?r=e=[e,n,o]:(Oe=r,r=u)):(Oe=r,r=u),r!==u?(e=Sn(),(n=Ye())!==u?(t,t=Tr(n)):(Oe=t,t=u)):(Oe=t,t=u));return t}())===u&&(t=function(){var t,r,e;t=Oe,(r=function(){var t,r,e,n,o;return t=Oe,r=Oe,(e=mn())!==u?(n=Sn(),(o=gn())!==u?r=e=[e,n,o]:(Oe=r,r=u)):(Oe=r,r=u),r!==u&&(t,r=Rr(r)),(t=r)===u&&(t=gn()),t}())!==u?(Sn(),(e=He())!==u?(t,t=Dr(r,e)):(Oe=t,t=u)):(Oe=t,t=u);return t}());return t}())===u&&(e=null),t,t=Sr(r,e)):(Oe=t,t=u),t}function We(){var r,e=function(t){0===Se&&Ne(t)};return e(pt),t.substr(Oe,2)===f?(r=f,Oe+=2):r=u,r===u&&(e(vt),62===t.charCodeAt(Oe)?(r=s,Oe++):r=u,r===u&&(e(ht),t.substr(Oe,2)===l?(r=l,Oe+=2):r=u,r===u&&(e(dt),t.substr(Oe,2)===p?(r=p,Oe+=2):r=u,r===u&&(e(bt),60===t.charCodeAt(Oe)?(r=v,Oe++):r=u,r===u&&(e(lt),61===t.charCodeAt(Oe)?(r=c,Oe++):r=u,r===u&&(e(yt),t.substr(Oe,2)===h?(r=h,Oe+=2):r=u)))))),r}function Ye(){var t,r,e,n,o,i;if(t=Oe,(r=Je())!==u){for(e=[],n=Oe,o=Sn(),(i=Je())!==u?n=o=[o,i]:(Oe=n,n=u);n!==u;)e.push(n),n=Oe,o=Sn(),(i=Je())!==u?n=o=[o,i]:(Oe=n,n=u);t,t=Er(r,e)}else Oe=t,t=u;return t}function Je(){var t,r,e,n,o,i;if(t=Oe,(r=Qe())!==u){for(e=[],n=Oe,o=Sn(),(i=Qe())!==u?n=o=[o,i]:(Oe=n,n=u);n!==u;)e.push(n),n=Oe,o=Sn(),(i=Qe())!==u?n=o=[o,i]:(Oe=n,n=u);t,t=Ir(r,e)}else Oe=t,t=u;return t}function Qe(){var t,r;return(t=on())===u&&(t=Ve())===u&&(t=Oe,En()!==u?(Sn(),(r=Xe())!==u?(Sn(),_n()!==u?(t,t=Mr(r)):(Oe=t,t=u)):(Oe=t,t=u)):(Oe=t,t=u),t===u&&(t=Oe,En()!==u?(Sn(),(r=Ke())!==u?(Sn(),_n()!==u?(t,t=Pr(r)):(Oe=t,t=u)):(Oe=t,t=u)):(Oe=t,t=u))),t}function Ve(){var r,e,n;return r=Oe,(e=$e())!==u?(Sn(),function(){var r;e=qt,0===Se&&Ne(e),46===t.charCodeAt(Oe)?(r=R,Oe++):r=u;var e;return r}()!==u?(Sn(),(n=rn())!==u?(r,r=qr(e,n)):(Oe=r,r=u)):(Oe=r,r=u)):(Oe=r,r=u),r===u&&(r=Oe,(e=rn())!==u&&(r,e=kr(e)),r=e),r}function $e(){var t,r,e,n,o;return t=Oe,r=Oe,(e=On())!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?r=e=[e,n]:(Oe=r,r=u)):(Oe=r,r=u),r!==u&&(t,r=Ur()),(t=r)===u&&(t=Oe,(r=function(){var t,r,e,n;if(t=Oe,(r=en())!==u){for(e=[],n=nn();n!==u;)e.push(n),n=nn();t,t=Br(r,e)}else Oe=t,t=u;return t}())!==u?(Oe,(e=(e=zr(r))?u:void 0)!==u?(t,t=Zr(r)):(Oe=t,t=u)):(Oe=t,t=u),t===u&&(t=Oe,(r=tn())!==u&&(t,r=Zr(r)),t=r)),t}function tn(){var r;return(r=function(){var r,e,n,o,i=function(t){0===Se&&Ne(t)};r=Oe,i(gt),34===t.charCodeAt(Oe)?(e=d,Oe++):e=u;if(e!==u){if(n=[],i(At),V.test(t.charAt(Oe))?(o=t.charAt(Oe),Oe++):o=u,o!==u)for(;o!==u;)n.push(o),i(At),V.test(t.charAt(Oe))?(o=t.charAt(Oe),Oe++):o=u;else n=u;n!==u?(i(gt),34===t.charCodeAt(Oe)?(o=d,Oe++):o=u,o!==u?(r,r=Kr(n)):(Oe=r,r=u)):(Oe=r,r=u)}else Oe=r,r=u;return r}())===u&&(r=function(){var r,e,n,o,i=function(t){0===Se&&Ne(t)};r=Oe,i(mt),39===t.charCodeAt(Oe)?(e=b,Oe++):e=u;if(e!==u){if(n=[],i(Ct),$.test(t.charAt(Oe))?(o=t.charAt(Oe),Oe++):o=u,o!==u)for(;o!==u;)n.push(o),i(Ct),$.test(t.charAt(Oe))?(o=t.charAt(Oe),Oe++):o=u;else n=u;n!==u?(i(mt),39===t.charCodeAt(Oe)?(o=b,Oe++):o=u,o!==u?(r,r=Kr(n)):(Oe=r,r=u)):(Oe=r,r=u)}else Oe=r,r=u;return r}())===u&&(r=function(){var r,e,n,o,i=function(t){0===Se&&Ne(t)};r=Oe,i(xt),96===t.charCodeAt(Oe)?(e=y,Oe++):e=u;if(e!==u){if(n=[],i(wt),tt.test(t.charAt(Oe))?(o=t.charAt(Oe),Oe++):o=u,o!==u)for(;o!==u;)n.push(o),i(wt),tt.test(t.charAt(Oe))?(o=t.charAt(Oe),Oe++):o=u;else n=u;n!==u?(i(xt),96===t.charCodeAt(Oe)?(o=y,Oe++):o=u,o!==u?(r,r=Kr(n)):(Oe=r,r=u)):(Oe=r,r=u)}else Oe=r,r=u;return r}()),r}function rn(){var t,r;return t=Oe,(r=function(){var t,r,e,n;if(t=Oe,(r=en())!==u){for(e=[],n=un();n!==u;)e.push(n),n=un();t,t=Br(r,e)}else Oe=t,t=u;return t}())!==u?(Oe,(zr(r)?u:void 0)!==u?(t,t=Xr(r)):(Oe=t,t=u)):(Oe=t,t=u),t===u&&(t=tn()),t}function en(){var r,e;return e=Ot,0===Se&&Ne(e),rt.test(t.charAt(Oe))?(r=t.charAt(Oe),Oe++):r=u,r}function nn(){var r,e;return e=Et,0===Se&&Ne(e),et.test(t.charAt(Oe))?(r=t.charAt(Oe),Oe++):r=u,r}function un(){var r,e;return e=_t,0===Se&&Ne(e),nt.test(t.charAt(Oe))?(r=t.charAt(Oe),Oe++):r=u,r}function on(){var r;return(r=function(){var r,e,n,o,i,a=function(t){0===Se&&Ne(t)};r=Oe,e=Oe,a(mt),39===t.charCodeAt(Oe)?(n=b,Oe++):n=u;if(n!==u){for(o=[],i=an();i!==u;)o.push(i),i=an();a(mt),39===t.charCodeAt(Oe)?(i=b,Oe++):i=u,i!==u?e=n=[n,o,i]:(Oe=e,e=u)}else Oe=e,e=u;e!==u&&(r,e=Yr(e));return r=e}())===u&&(r=cn())===u&&(r=function(){var r,e;r=Oe,(e=function(){var r,e,n,o,i;return r=Oe,i=Xt,0===Se&&Ne(i),t.substr(Oe,4).toLowerCase()===F?(e=t.substr(Oe,4),Oe+=4):e=u,e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?r=e=[e,n]:(Oe=r,r=u)):(Oe=r,r=u),r}())!==u&&(r,e=Hr());(r=e)===u&&(r=Oe,(e=function(){var r,e,n,o;r=Oe,i=Bt,0===Se&&Ne(i),t.substr(Oe,5).toLowerCase()===T?(e=t.substr(Oe,5),Oe+=5):e=u;var i;e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?r=e=[e,n]:(Oe=r,r=u)):(Oe=r,r=u);return r}())!==u&&(r,e=Wr()),r=e);return r}())===u&&(r=function(){var r,e;r=Oe,(e=function(){var r,e,n,o,i;return r=Oe,i=Kt,0===Se&&Ne(i),t.substr(Oe,4).toLowerCase()===j?(e=t.substr(Oe,4),Oe+=4):e=u,e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?r=e=[e,n]:(Oe=r,r=u)):(Oe=r,r=u),r}())!==u&&(r,e=Gr());return r=e}()),r}function an(){var r,e;return e=St,0===Se&&Ne(e),ut.test(t.charAt(Oe))?(r=t.charAt(Oe),Oe++):r=u,r===u&&(r=function(){var r,e,n,o,i,a,c=function(t){0===Se&&Ne(t)};r=Oe,c(Lt),t.substr(Oe,2)===A?(e=A,Oe+=2):e=u;e!==u&&(r,e=Jr());(r=e)===u&&(r=Oe,c(Rt),t.substr(Oe,2)===m?(e=m,Oe+=2):e=u,e!==u&&(r,e=Qr()),(r=e)===u&&(r=Oe,c(jt),t.substr(Oe,2)===C?(e=C,Oe+=2):e=u,e!==u&&(r,e=Vr()),(r=e)===u&&(r=Oe,c(Ft),t.substr(Oe,2)===x?(e=x,Oe+=2):e=u,e!==u&&(r,e=$r()),(r=e)===u&&(r=Oe,c(Tt),t.substr(Oe,2)===w?(e=w,Oe+=2):e=u,e!==u&&(r,e=te()),(r=e)===u&&(r=Oe,c(Dt),t.substr(Oe,2)===O?(e=O,Oe+=2):e=u,e!==u&&(r,e=re()),(r=e)===u&&(r=Oe,c(Nt),t.substr(Oe,2)===E?(e=E,Oe+=2):e=u,e!==u&&(r,e=ee()),(r=e)===u&&(r=Oe,c(It),t.substr(Oe,2)===_?(e=_,Oe+=2):e=u,e!==u&&(r,e=ne()),(r=e)===u&&(r=Oe,c(Mt),t.substr(Oe,2)===S?(e=S,Oe+=2):e=u,e!==u&&(r,e=ue()),(r=e)===u&&(r=Oe,c(Pt),t.substr(Oe,2)===L?(e=L,Oe+=2):e=u,e!==u&&(n=hn())!==u&&(o=hn())!==u&&(i=hn())!==u&&(a=hn())!==u?(r,r=oe(n,o,i,a)):(Oe=r,r=u))))))))));return r}()),r}function cn(){var t,r;return t=Oe,(r=function(){var t,r,e,n;t=Oe,(r=fn())!==u&&(e=sn())!==u&&(n=ln())!==u?(Sn(),t,t=ae(r,e,n)):(Oe=t,t=u);t===u&&(t=Oe,(r=fn())!==u&&(e=sn())!==u?(n=Sn(),t,t=ce(r,e)):(Oe=t,t=u),t===u&&(t=Oe,(r=fn())!==u&&(e=ln())!==u?(n=Sn(),t,t=fe(r,e)):(Oe=t,t=u),t===u&&(t=Oe,(r=fn())!==u?(e=Sn(),t,t=se(r)):(Oe=t,t=u))));return t}())!==u&&(t,r=ie(r)),t=r}function fn(){var t;return(t=pn())===u&&(t=vn()),t}function sn(){var r,e,n,o;return r=Oe,o=qt,0===Se&&Ne(o),46===t.charCodeAt(Oe)?(e=R,Oe++):e=u,e!==u&&(n=pn())!==u?(r,r=le(n)):(Oe=r,r=u),r}function ln(){var r,e,n;return r=Oe,(e=function(){var r,e,n,o=function(t){0===Se&&Ne(t)};r=Oe,o(zt),at.test(t.charAt(Oe))?(e=t.charAt(Oe),Oe++):e=u;e!==u?(o(Zt),ct.test(t.charAt(Oe))?(n=t.charAt(Oe),Oe++):n=u,n===u&&(n=null),r,r=he(e,n)):(Oe=r,r=u);return r}())!==u&&(n=pn())!==u?(r,r=pe(e,n)):(Oe=r,r=u),r}function pn(){var t,r,e;if(t=Oe,r=[],(e=vn())!==u)for(;e!==u;)r.push(e),e=vn();else r=u;return r!==u&&(t,r=ve(r)),t=r}function vn(){var r,e;return e=kt,0===Se&&Ne(e),ot.test(t.charAt(Oe))?(r=t.charAt(Oe),Oe++):r=u,r}function hn(){var r,e;return e=Ut,0===Se&&Ne(e),it.test(t.charAt(Oe))?(r=t.charAt(Oe),Oe++):r=u,r}function dn(){var r,e,n,o,i;return r=Oe,i=Jt,0===Se&&Ne(i),t.substr(Oe,2).toLowerCase()===P?(e=t.substr(Oe,2),Oe+=2):e=u,e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?r=e=[e,n]:(Oe=r,r=u)):(Oe=r,r=u),r}function bn(){var r,e,n,o,i;return r=Oe,i=rr,0===Se&&Ne(i),t.substr(Oe,2).toLowerCase()===Z?(e=t.substr(Oe,2),Oe+=2):e=u,e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?(r,r=ye()):(Oe=r,r=u)):(Oe=r,r=u),r}function yn(){var r,e,n,o,i;return r=Oe,i=er,0===Se&&Ne(i),t.substr(Oe,2).toLowerCase()===K?(e=t.substr(Oe,2),Oe+=2):e=u,e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?(r,r=ge()):(Oe=r,r=u)):(Oe=r,r=u),r}function gn(){var r,e,n,o,i;return r=Oe,i=nr,0===Se&&Ne(i),t.substr(Oe,4).toLowerCase()===X?(e=t.substr(Oe,4),Oe+=4):e=u,e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?(r,r=Ae()):(Oe=r,r=u)):(Oe=r,r=u),r}function An(){var r,e,n,o,i;return r=Oe,i=ur,0===Se&&Ne(i),t.substr(Oe,6).toLowerCase()===B?(e=t.substr(Oe,6),Oe+=6):e=u,e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?(r,r=me()):(Oe=r,r=u)):(Oe=r,r=u),r}function mn(){var r,e,n,o,i;return r=Oe,i=or,0===Se&&Ne(i),t.substr(Oe,3).toLowerCase()===G?(e=t.substr(Oe,3),Oe+=3):e=u,e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?(r,r=Ce()):(Oe=r,r=u)):(Oe=r,r=u),r}function Cn(){var r,e,n,o,i;return r=Oe,i=ir,0===Se&&Ne(i),t.substr(Oe,3).toLowerCase()===H?(e=t.substr(Oe,3),Oe+=3):e=u,e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?(r,r=xe()):(Oe=r,r=u)):(Oe=r,r=u),r}function xn(){var r,e,n,o,i;return r=Oe,i=ar,0===Se&&Ne(i),t.substr(Oe,2).toLowerCase()===W?(e=t.substr(Oe,2),Oe+=2):e=u,e!==u?(n=Oe,De(),o=en(),Ie(!0),o===u?n=void 0:(Oe=n,n=u),n!==u?(r,r=we()):(Oe=r,r=u)):(Oe=r,r=u),r}function wn(){var r,e;return e=cr,0===Se&&Ne(e),44===t.charCodeAt(Oe)?(r=Y,Oe++):r=u,r}function On(){var r,e;return e=fr,0===Se&&Ne(e),42===t.charCodeAt(Oe)?(r=g,Oe++):r=u,r}function En(){var r,e;return e=sr,0===Se&&Ne(e),40===t.charCodeAt(Oe)?(r=J,Oe++):r=u,r}function _n(){var r,e;return e=lr,0===Se&&Ne(e),41===t.charCodeAt(Oe)?(r=Q,Oe++):r=u,r}function Sn(){var t,r;for(t=[],r=Ln();r!==u;)t.push(r),r=Ln();return t}function Ln(){var r,e;return e=pr,0===Se&&Ne(e),ft.test(t.charAt(Oe))?(r=t.charAt(Oe),Oe++):r=u,r}var Rn={AND:!0,ASC:!0,BY:!0,CONTAINS:!0,DESC:!0,EXISTS:!0,FALSE:!0,FROM:!0,GROUP:!0,IN:!0,IS:!0,LIKE:!0,LIMIT:!0,NOT:!0,NULL:!0,OR:!0,ORDER:!0,SELECT:!0,TRUE:!0,WHERE:!0};function jn(t,r){return{type:"unary_expr",operator:t,expr:r}}function Fn(t,r,e){return{type:"binary_expr",operator:t,left:r,right:e}}function Tn(t,r){for(var e=[t],n=0;n<r.length;n++)e.push(r[n][3]);return e}function Dn(t,r){for(var e=t,n=0;n<r.length;n++)e=Fn(r[n][1],e,r[n][3]);return e}if(De(),(e=i())!==u&&Oe===t.length)return e;throw e!==u&&Oe<t.length&&Ne({type:"end"}),function(){var r=_e[0],e=r.pos;return Me(r.variants,e<t.length?t.charAt(e):null,e<t.length?Te(e,e+1):Te(e,e))}()}Object.defineProperty(r,"__esModule",{value:!0}),r.SyntaxError=n,r.parse=u,r.default=void 0,function(t,r){function e(){this.constructor=t}e.prototype=r.prototype,t.prototype=new e}(n,Error),n.buildMessage=function(t,r){var e={literal:function(t){return'"'+u(t.text)+'"'},class:function(t){var r=t.parts.map(function(t){return Array.isArray(t)?o(t[0])+"-"+o(t[1]):o(t)});return"["+(t.inverted?"^":"")+r+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description},not:function(t){return"not "+i(t.expected)}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function u(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+n(t)})}function o(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+n(t)})}function i(t){return e[t.type](t)}return"Expected "+function(t){var r,e,n=t.map(i);if(n.sort(),n.length>0){for(r=1,e=1;r<n.length;r++)n[r-1]!==n[r]&&(n[e]=n[r],e++);n.length=e}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(t)+" but "+function(t){return t?'"'+u(t)+'"':"end of input"}(r)+" found."};var o={SyntaxError:n,parse:u};r.default=o},function(t,r,e){"use strict";function n(t,r){var e=r.entries().next().value[0];function u(t){var u=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!t)return;if(t.type==="binary_expr"){if(t.operator==="AND"||t.operator==="OR"){n(t.left,r,t.operator);n(t.right,r,t.operator)}else if(t.operator==="="){if(!t.left.table)t.left.table=e;if(!r.has(t.left.table))throw Error("Table ".concat(t.left.table," was not specified in FROM statement"));var o=t.left.table;var i=t.left.column;var a=t.right.column||t.right.value;t["selector"]={table:o,selector:"[".concat(i,'="').concat(a,'"]')};t.type="selector";delete t.left;delete t.right;delete t.operator}}t.parent=u}u(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.transpile=function(t){var r=function(t){var r=new Set;return t.forEach(function(t){if("table_ref"!==t.type)throw new Error("Expected ".concat(t," to be a table_ref"));r.add(t.table)}),r}(t.from);!function t(r,e){var n=e.entries().next().value[0];function u(r){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(r){if("binary_expr"===r.type)if("AND"===r.operator||"OR"===r.operator)t(r.left,e,r.operator),t(r.right,e,r.operator);else if("="===r.operator){if(r.left.table||(r.left.table=n),!e.has(r.left.table))throw Error("Table ".concat(r.left.table," was not specified in FROM statement"));var o=r.left.table,i=r.left.column,a=r.right.column||r.right.value;r.selector={table:o,selector:"[".concat(i,'="').concat(a,'"]')},r.type="selector",delete r.left,delete r.right,delete r.operator}r.parent=u}}!function u(r){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!r)return;if("binary_expr"===r.type)if("AND"===r.operator||"OR"===r.operator)!function t(r,e){var n=e.entries().next().value[0];function u(r){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(r){if("binary_expr"===r.type)if("AND"===r.operator||"OR"===r.operator)t(r.left,e,r.operator),t(r.right,e,r.operator);else if("="===r.operator){if(r.left.table||(r.left.table=n),!e.has(r.left.table))throw Error("Table ".concat(r.left.table," was not specified in FROM statement"));var o=r.left.table,i=r.left.column,a=r.right.column||r.right.value;r.selector={table:o,selector:"[".concat(i,'="').concat(a,'"]')},r.type="selector",delete r.left,delete r.right,delete r.operator}r.parent=u}}u(r)}(r.left,e,r.operator),t(r.right,e,r.operator);else if("="===r.operator){if(r.left.table||(r.left.table=n),!e.has(r.left.table))throw Error("Table ".concat(r.left.table," was not specified in FROM statement"));var o=r.left.table,i=r.left.column,a=r.right.column||r.right.value;r.selector={table:o,selector:"[".concat(i,'="').concat(a,'"]')},r.type="selector",delete r.left,delete r.right,delete r.operator}r.parent=u}(r)}(t.where,r);var e={};r.forEach(function(t){e[t]=[""]}),function(t,r){if(!t)return;var e=!1,n=!1;!function t(u){if("selector"===u.type){var o=r[u.selector.table];if(n)return o.push(o[o.length-1]),n=!1,void(o[o.length-2]+=u.selector.selector);e&&(""!==o[o.length-1]&&o.push(""),e=!1),o[o.length-1]+=u.selector.selector}if("binary_expr"===u.type){var i=u.left,a=u.right;"AND"===u.operator?(t(i),t(a)):"OR"===u.operator&&("AND"===u.parent&&(n=!0),t(i),"AND"!==u.parent&&(e=!0),t(a))}}(t)}(t.where,e);var n=[function(t){var r=[];for(var e in t){for(var n="",u=0;u<t[e].length;u++)n+=e+t[e][u],u<t[e].length-1&&(n+=", ");r.push(n)}return r.join(", ")}(e)];t.limit&&1===t.limit.value?n.push(document.querySelector.bind(document)):n.push(document.querySelectorAll.bind(document));return n}},function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.sort=function(t,r){return r.sort(t),r},r.execute=function(t){if(!t||0===t.length)return null;for(var r=t[0],e=1;e<t.length;e++)r=t[e](r);return r}}])});