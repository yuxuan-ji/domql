!function(r,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("domql",[],t):"object"==typeof exports?exports.domql=t():r.domql=t()}("undefined"!=typeof self?self:this,function(){return function(r){var t={};function e(n){if(t[n])return t[n].exports;var u=t[n]={i:n,l:!1,exports:{}};return r[n].call(u.exports,u,u.exports,e),u.l=!0,u.exports}return e.m=r,e.c=t,e.d=function(r,t,n){e.o(r,t)||Object.defineProperty(r,t,{enumerable:!0,get:n})},e.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,t){if(1&t&&(r=e(r)),8&t)return r;if(4&t&&"object"==typeof r&&r&&r.__esModule)return r;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:r}),2&t&&"string"!=typeof r)for(var u in r)e.d(n,u,function(t){return r[t]}.bind(null,u));return n},e.n=function(r){var t=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(t,"a",t),t},e.o=function(r,t){return Object.prototype.hasOwnProperty.call(r,t)},e.p="",e(e.s=1)}([function(r,t,e){"use strict";function n(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Directives=void 0;var u=function(){function r(){!function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r)}var t,e,u;return t=r,u=[{key:"sort",value:function(r,t){return t.sort(r),t}},{key:"limiter",value:function(r,t){var e=t.splice(0,r);return 1===e.length?e[0]:e}},{key:"execute",value:function(r){if(!r||0===r.length)return null;for(var t=r[0],e=1;e<r.length;e++)t=r[e](t);return t}}],(e=null)&&n(t.prototype,e),u&&n(t,u),r}();t.Directives=u},function(r,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Domql=void 0;var n=e(2),u=e(4),o=e(0);function i(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}var a=function(){function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this._name="Domql",this.compile(t)}var t,e,a;return t=r,(e=[{key:"compile",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this._query=r,r){var t=n.Parser.parse(r);this._directives=u.Transpiler.transpile(t)}}},{key:"execute",value:function(){return o.Directives.execute(this._directives)}},{key:"name",get:function(){return this._name}},{key:"query",get:function(){return this._query}}])&&i(t.prototype,e),a&&i(t,a),r}();t.Domql=a},function(r,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=void 0;var n=e(3);function u(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}var o=function(){function r(){!function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r)}var t,e,o;return t=r,o=[{key:"parse",value:function(r){return(0,n.parse)(r)}}],(e=null)&&u(t.prototype,e),o&&u(t,o),r}();t.Parser=o},function(r,t,e){"use strict";function n(r,t,e,u){this.message=r,this.expected=t,this.found=e,this.location=u,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}function u(r,t){t=void 0!==t?t:{};var e,u={},o={start:te},i=te,a="!",c="=",f=">=",l=">",s="<=",v="<>",p="<",h="!=",d='"',y="'",b="`",g="*",m=".",A="null",C="true",_="false",E="select",w="from",S="where",x="group",O="by",L="order",T="limit",j="asc",k="desc",R="in",D="is",P="like",I="exists",N="not",F="and",M="or",q=",",U="(",z=")",Q=/^[^"]/,Z=/^[^']/,W=/^[^`]/,K=/^[A-Za-z_]/,X=/^[A-Za-z0-9_]/,B=/^[A-Za-z0-9_:]/,G=/^[0-9]/,H=/^[eE]/,Y=/^[+\-]/,J=/^[ \t\n\r]/,V=Xt("!",!1),$=Xt("=",!1),rr=Xt(">=",!1),tr=Xt(">",!1),er=Xt("<=",!1),nr=Xt("<>",!1),ur=Xt("<",!1),or=Xt("!=",!1),ir=Xt('"',!1),ar=Bt(['"'],!0,!1),cr=Xt("'",!1),fr=Bt(["'"],!0,!1),lr=Xt("`",!1),sr=Bt(["`"],!0,!1),vr=Bt([["A","Z"],["a","z"],"_"],!1,!1),pr=Bt([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),hr=Bt([["A","Z"],["a","z"],["0","9"],"_",":"],!1,!1),dr=Xt(".",!1),yr=Bt([["0","9"]],!1,!1),br=Bt(["e","E"],!1,!1),gr=Bt(["+","-"],!1,!1),mr=Xt("NULL",!0),Ar=Xt("TRUE",!0),Cr=Xt("FALSE",!0),_r=Xt("SELECT",!0),Er=Xt("FROM",!0),wr=Xt("WHERE",!0),Sr=Xt("GROUP",!0),xr=Xt("BY",!0),Or=Xt("ORDER",!0),Lr=Xt("LIMIT",!0),Tr=Xt("ASC",!0),jr=Xt("DESC",!0),kr=Xt("IN",!0),Rr=Xt("IS",!0),Dr=Xt("LIKE",!0),Pr=Xt("EXISTS",!0),Ir=Xt("NOT",!0),Nr=Xt("AND",!0),Fr=Xt("OR",!0),Mr=Xt(",",!1),qr=Xt("*",!1),Ur=Xt("(",!1),zr=Xt(")",!1),Qr=Bt([" ","\t","\n","\r"],!1,!1),Zr=function(r,t,e,n,u,o){return{type:"select",columns:r,from:t,where:e,groupby:n,orderby:u,limit:o}},Wr=function(){return[{type:"column_ref",column:"*"}]},Kr=function(r,t){return Ke(r,t)},Xr=function(r){return r},Br=function(r){return r},Gr=function(){return{type:"table_ref",table:"*"}},Hr=function(r){return{type:"table_ref",table:r}},Yr=function(r){return r},Jr=function(r,t){var e=r;return e.order="ASC","DESC"===t&&(e.order="DESC"),e},Vr=function(r){return r},$r=function(r,t){var e={type:"expr_list"};return e.value=Ke(r,t),e},rt=function(r,t){return Xe(r,t)},tt=function(r){return Ze("NOT",r)},et=function(r,t){return null===t?r:"arithmetic"===t.type?Xe(r,t.tail):We(t.op,r,t.right)},nt=function(r,t){return t.parentheses=!0,Ze(r,t)},ut=function(r){return r[0]+" "+r[2]},ot=function(r){return{type:"arithmetic",tail:r}},it=function(r){return{op:"IS",right:r}},at=function(r){return{op:"IS NOT",right:r}},ct=function(r,t){return{op:r,right:t}},ft=function(r,t){return{op:r,right:t}},lt=function(r,t){return Xe(r,t)},st=function(r){return r.parentheses=!0,r},vt=function(r){return r.parentheses=!0,r},pt=function(r,t){return{type:"column_ref",column:r,field:t}},ht=function(r){return{type:"column_ref",column:r}},dt=function(r){return!0===Qe[r.toUpperCase()]},yt=function(r){return r},bt=function(r){return r.join("")},gt=function(r){return r},mt=function(r,t){return r+t.join("")},At=function(){return{type:"null",value:null}},Ct=function(){return{type:"bool",value:!0}},_t=function(){return{type:"bool",value:!1}},Et=function(r){return{type:"string",value:r}},wt=function(r){return{type:"number",value:r}},St=function(r,t,e){return parseFloat(r+t+e)},xt=function(r,t){return parseFloat(r+t)},Ot=function(r,t){return parseFloat(r+t)},Lt=function(r){return parseFloat(r)},Tt=function(r){return"."+r},jt=function(r,t){return r+t},kt=function(r){return r.join("")},Rt=function(r,t){return r+(null!==t?t:"")},Dt=function(){return"ASC"},Pt=function(){return"DESC"},It=function(){return"IN"},Nt=function(){return"IS"},Ft=function(){return"LIKE"},Mt=function(){return"EXISTS"},qt=function(){return"NOT"},Ut=function(){return"AND"},zt=function(){return"OR"},Qt=0,Zt=[{line:1,column:1}],Wt=[],Kt=0;if("startRule"in t){if(!(t.startRule in o))throw new Error("Can't start parsing from rule \""+t.startRule+'".');i=o[t.startRule]}function Xt(r,t){return{type:"literal",text:r,ignoreCase:t}}function Bt(r,t,e){return{type:"class",parts:r,inverted:t,ignoreCase:e}}function Gt(t){var e,n=Zt[t];if(n)return n;for(e=t-1;!Zt[e];)e--;for(n={line:(n=Zt[e]).line,column:n.column};e<t;)10===r.charCodeAt(e)?(n.line++,n.column=1):n.column++,e++;return Zt[t]=n,n}var Ht="string"==typeof t.filename&&t.filename.length>0;function Yt(r,e){var n={};Ht&&(n.filename=t.filename);var u=Gt(r);n.start={offset:r,line:u.line,column:u.column};var o=Gt(e);return n.end={offset:e,line:o.line,column:o.column},n}function Jt(){Wt.push({pos:Qt,variants:[]})}function Vt(r){var t=Wt[Wt.length-1];Qt<t.pos||(Qt>t.pos&&(t.pos=Qt,t.variants=[]),t.variants.push(r))}function $t(r){var t=Wt.pop(),e=Wt[Wt.length-1],n=t.variants;e.pos===t.pos&&(r&&(n=n.map(function(r){return"not"===r.type?r.expected:{type:"not",expected:r}})),Array.prototype.push.apply(e.variants,n))}function re(r,t,e){return new n(n.buildMessage(r,t),r,t,e)}function te(){return ee()}function ee(){var t,e,n,o,i,a,c;return t=Qt,Ue(),function(){var t,e,n,o;t=Qt,i=_r,0===Kt&&Vt(i),r.substr(Qt,6).toLowerCase()===E?(e=r.substr(Qt,6),Qt+=6):e=u;var i;e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?t=e=[e,n]:(Qt=t,t=u)):(Qt=t,t=u);return t}()!==u?(Ue(),(e=function(){var r,t,e,n,o,i,a,c;r=Qt,t=Qt,(e=Fe())!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?t=e=[e,n]:(Qt=t,t=u)):(Qt=t,t=u);t!==u&&(r,t=Wr());if((r=t)===u)if(r=Qt,(t=ne())!==u){for(e=[],n=Qt,o=Ue(),(i=Ne())!==u?(a=Ue(),(c=ne())!==u?n=o=[o,i,a,c]:(Qt=n,n=u)):(Qt=n,n=u);n!==u;)e.push(n),n=Qt,o=Ue(),(i=Ne())!==u?(a=Ue(),(c=ne())!==u?n=o=[o,i,a,c]:(Qt=n,n=u)):(Qt=n,n=u);r,r=Kr(t,e)}else Qt=r,r=u;return r}())!==u?(Ue(),(n=function(){var t,e;t=Qt,function(){var t,e,n,o,i;return t=Qt,i=Er,0===Kt&&Vt(i),r.substr(Qt,4).toLowerCase()===w?(e=r.substr(Qt,4),Qt+=4):e=u,e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?t=e=[e,n]:(Qt=t,t=u)):(Qt=t,t=u),t}()!==u?(Ue(),(e=function(){var r,t,e,n,o;r=Qt,t=Qt,(e=Fe())!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?t=e=[e,n]:(Qt=t,t=u)):(Qt=t,t=u);t!==u&&(r,t=Gr());(r=t)===u&&(r=Qt,(t=de())!==u&&(r,t=Hr(t)),r=t);return r}())!==u?(t,t=Br(e)):(Qt=t,t=u)):(Qt=t,t=u);return t}())===u&&(n=null),Ue(),(o=function(){var t,e;t=Qt,function(){var t,e,n,o,i;return t=Qt,i=wr,0===Kt&&Vt(i),r.substr(Qt,5).toLowerCase()===S?(e=r.substr(Qt,5),Qt+=5):e=u,e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?t=e=[e,n]:(Qt=t,t=u)):(Qt=t,t=u),t}()!==u?(Ue(),(e=ie())!==u?(t,t=Yr(e)):(Qt=t,t=u)):(Qt=t,t=u);return t}())===u&&(o=null),Ue(),(i=function(){var t,e;t=Qt,function(){var t,e,n,o,i;return t=Qt,i=Sr,0===Kt&&Vt(i),r.substr(Qt,5).toLowerCase()===x?(e=r.substr(Qt,5),Qt+=5):e=u,e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?t=e=[e,n]:(Qt=t,t=u)):(Qt=t,t=u),t}()!==u?(Ue(),Le()!==u?(Ue(),(e=function(){var r,t,e,n,o,i,a,c;if(r=Qt,(t=he())!==u){for(e=[],n=Qt,o=Ue(),(i=Ne())!==u?(a=Ue(),(c=he())!==u?n=o=[o,i,a,c]:(Qt=n,n=u)):(Qt=n,n=u);n!==u;)e.push(n),n=Qt,o=Ue(),(i=Ne())!==u?(a=Ue(),(c=he())!==u?n=o=[o,i,a,c]:(Qt=n,n=u)):(Qt=n,n=u);r,r=Kr(t,e)}else Qt=r,r=u;return r}())!==u?(t,t=Br(e)):(Qt=t,t=u)):(Qt=t,t=u)):(Qt=t,t=u);return t}())===u&&(i=null),Ue(),(a=function(){var t,e;t=Qt,function(){var t,e,n,o,i;return t=Qt,i=Or,0===Kt&&Vt(i),r.substr(Qt,5).toLowerCase()===L?(e=r.substr(Qt,5),Qt+=5):e=u,e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?t=e=[e,n]:(Qt=t,t=u)):(Qt=t,t=u),t}()!==u?(Ue(),Le()!==u?(Ue(),(e=function(){var r,t,e,n,o,i,a,c;if(r=Qt,(t=ue())!==u){for(e=[],n=Qt,o=Ue(),(i=Ne())!==u?(a=Ue(),(c=ue())!==u?n=o=[o,i,a,c]:(Qt=n,n=u)):(Qt=n,n=u);n!==u;)e.push(n),n=Qt,o=Ue(),(i=Ne())!==u?(a=Ue(),(c=ue())!==u?n=o=[o,i,a,c]:(Qt=n,n=u)):(Qt=n,n=u);r,r=Kr(t,e)}else Qt=r,r=u;return r}())!==u?(t,t=Br(e)):(Qt=t,t=u)):(Qt=t,t=u)):(Qt=t,t=u);return t}())===u&&(a=null),Ue(),(c=function(){var t,e;t=Qt,function(){var t,e,n,o,i;return t=Qt,i=Lr,0===Kt&&Vt(i),r.substr(Qt,5).toLowerCase()===T?(e=r.substr(Qt,5),Qt+=5):e=u,e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?t=e=[e,n]:(Qt=t,t=u)):(Qt=t,t=u),t}()!==u?(Ue(),(e=_e())!==u?(t,t=Vr(e)):(Qt=t,t=u)):(Qt=t,t=u);return t}())===u&&(c=null),t,t=Zr(e,n,o,i,a,c)):(Qt=t,t=u)):(Qt=t,t=u),t}function ne(){var r,t;return r=Qt,(t=he())!==u&&(r,t=Xr(t)),r=t}function ue(){var t,e,n;return t=Qt,(e=he())!==u?(Ue(),(n=function(){var t,e,n,o;t=Qt,i=jr,0===Kt&&Vt(i),r.substr(Qt,4).toLowerCase()===k?(e=r.substr(Qt,4),Qt+=4):e=u;var i;e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?(t,t=Pt()):(Qt=t,t=u)):(Qt=t,t=u);return t}())===u&&(n=function(){var t,e,n,o;t=Qt,i=Tr,0===Kt&&Vt(i),r.substr(Qt,3).toLowerCase()===j?(e=r.substr(Qt,3),Qt+=3):e=u;var i;e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?(t,t=Dt()):(Qt=t,t=u)):(Qt=t,t=u);return t}()),n===u&&(n=null),t,t=Jr(e,n)):(Qt=t,t=u),t}function oe(){var r,t,e,n,o,i,a,c;if(r=Qt,(t=ie())!==u){for(e=[],n=Qt,o=Ue(),(i=Ne())!==u?(a=Ue(),(c=ie())!==u?n=o=[o,i,a,c]:(Qt=n,n=u)):(Qt=n,n=u);n!==u;)e.push(n),n=Qt,o=Ue(),(i=Ne())!==u?(a=Ue(),(c=ie())!==u?n=o=[o,i,a,c]:(Qt=n,n=u)):(Qt=n,n=u);r,r=$r(t,e)}else Qt=r,r=u;return r}function ie(){var r,t,e,n,o,i,a,c;if(r=Qt,(t=ae())!==u){for(e=[],n=Qt,o=Ue(),(i=Ie())!==u?(a=Ue(),(c=ae())!==u?n=o=[o,i,a,c]:(Qt=n,n=u)):(Qt=n,n=u);n!==u;)e.push(n),n=Qt,o=Ue(),(i=Ie())!==u?(a=Ue(),(c=ae())!==u?n=o=[o,i,a,c]:(Qt=n,n=u)):(Qt=n,n=u);r,r=rt(t,e)}else Qt=r,r=u;return r}function ae(){var r,t,e,n,o,i,a,c;if(r=Qt,(t=ce())!==u){for(e=[],n=Qt,o=Ue(),(i=Pe())!==u?(a=Ue(),(c=ce())!==u?n=o=[o,i,a,c]:(Qt=n,n=u)):(Qt=n,n=u);n!==u;)e.push(n),n=Qt,o=Ue(),(i=Pe())!==u?(a=Ue(),(c=ce())!==u?n=o=[o,i,a,c]:(Qt=n,n=u)):(Qt=n,n=u);r,r=rt(t,e)}else Qt=r,r=u;return r}function ce(){var t,e,n,o,i,f=function(r){0===Kt&&Vt(r)};return(t=fe())===u&&(t=function(){var r,t,e;r=Qt,(t=function(){var r,t,e,n,o;return r=Qt,t=Qt,(e=De())!==u?(n=Ue(),(o=Re())!==u?t=e=[e,n,o]:(Qt=t,t=u)):(Qt=t,t=u),t!==u&&(r,t=ut(t)),(r=t)===u&&(r=Re()),r}())!==u?(Ue(),Me()!==u?(Ue(),(e=ee())!==u?(Ue(),qe()!==u?(r,r=nt(t,e)):(Qt=r,r=u)):(Qt=r,r=u)):(Qt=r,r=u)):(Qt=r,r=u);return r}())===u&&(t=Qt,(e=De())===u&&(e=Qt,f(V),33===r.charCodeAt(Qt)?(n=a,Qt++):n=u,n!==u?(o=Qt,Jt(),f($),61===r.charCodeAt(Qt)?(i=c,Qt++):i=u,$t(!0),i===u?o=void 0:(Qt=o,o=u),o!==u?e=n=[n,o]:(Qt=e,e=u)):(Qt=e,e=u)),e!==u?(n=Ue(),(o=ce())!==u?(t,t=tt(o)):(Qt=t,t=u)):(Qt=t,t=u)),t}function fe(){var r,t,e;return r=Qt,(t=se())!==u?(Ue(),(e=function(){var r;(r=function(){var r,t,e,n,o,i,a;if(r=Qt,t=[],e=Qt,n=Ue(),(o=le())!==u?(i=Ue(),(a=se())!==u?e=n=[n,o,i,a]:(Qt=e,e=u)):(Qt=e,e=u),e!==u)for(;e!==u;)t.push(e),e=Qt,n=Ue(),(o=le())!==u?(i=Ue(),(a=se())!==u?e=n=[n,o,i,a]:(Qt=e,e=u)):(Qt=e,e=u);else t=u;return t!==u&&(r,t=ot(t)),r=t}())===u&&(r=function(){var r,t,e;r=Qt,(t=function(){var r,t,e,n,o;return r=Qt,t=Qt,(e=De())!==u?(n=Ue(),(o=Te())!==u?t=e=[e,n,o]:(Qt=t,t=u)):(Qt=t,t=u),t!==u&&(r,t=ut(t)),(r=t)===u&&(r=Te()),r}())!==u?(Ue(),Me()!==u?(Ue(),(e=oe())!==u?(Ue(),qe()!==u?(r,r=ft(t,e)):(Qt=r,r=u)):(Qt=r,r=u)):(Qt=r,r=u)):(Qt=r,r=u);return r}())===u&&(r=function(){var r,t,e,n,o;r=Qt,(t=je())!==u?(e=Ue(),(n=se())!==u?(r,r=it(n)):(Qt=r,r=u)):(Qt=r,r=u);r===u&&(r=Qt,t=Qt,(e=je())!==u?(n=Ue(),(o=De())!==u?t=e=[e,n,o]:(Qt=t,t=u)):(Qt=t,t=u),t!==u?(e=Ue(),(n=se())!==u?(r,r=at(n)):(Qt=r,r=u)):(Qt=r,r=u));return r}())===u&&(r=function(){var r,t,e;r=Qt,(t=function(){var r,t,e,n,o;return r=Qt,t=Qt,(e=De())!==u?(n=Ue(),(o=ke())!==u?t=e=[e,n,o]:(Qt=t,t=u)):(Qt=t,t=u),t!==u&&(r,t=ut(t)),(r=t)===u&&(r=ke()),r}())!==u?(Ue(),(e=fe())!==u?(r,r=ct(t,e)):(Qt=r,r=u)):(Qt=r,r=u);return r}());return r}())===u&&(e=null),r,r=et(t,e)):(Qt=r,r=u),r}function le(){var t,e=function(r){0===Kt&&Vt(r)};return e(rr),r.substr(Qt,2)===f?(t=f,Qt+=2):t=u,t===u&&(e(tr),62===r.charCodeAt(Qt)?(t=l,Qt++):t=u,t===u&&(e(er),r.substr(Qt,2)===s?(t=s,Qt+=2):t=u,t===u&&(e(nr),r.substr(Qt,2)===v?(t=v,Qt+=2):t=u,t===u&&(e(ur),60===r.charCodeAt(Qt)?(t=p,Qt++):t=u,t===u&&(e($),61===r.charCodeAt(Qt)?(t=c,Qt++):t=u,t===u&&(e(or),r.substr(Qt,2)===h?(t=h,Qt+=2):t=u)))))),t}function se(){var r,t,e,n,o,i;if(r=Qt,(t=ve())!==u){for(e=[],n=Qt,o=Ue(),(i=ve())!==u?n=o=[o,i]:(Qt=n,n=u);n!==u;)e.push(n),n=Qt,o=Ue(),(i=ve())!==u?n=o=[o,i]:(Qt=n,n=u);r,r=rt(t,e)}else Qt=r,r=u;return r}function ve(){var r,t,e,n,o,i;if(r=Qt,(t=pe())!==u){for(e=[],n=Qt,o=Ue(),(i=pe())!==u?n=o=[o,i]:(Qt=n,n=u);n!==u;)e.push(n),n=Qt,o=Ue(),(i=pe())!==u?n=o=[o,i]:(Qt=n,n=u);r,r=lt(t,e)}else Qt=r,r=u;return r}function pe(){var r,t;return(r=Ce())===u&&(r=he())===u&&(r=Qt,Me()!==u?(Ue(),(t=ie())!==u?(Ue(),qe()!==u?(r,r=st(t)):(Qt=r,r=u)):(Qt=r,r=u)):(Qt=r,r=u),r===u&&(r=Qt,Me()!==u?(Ue(),(t=oe())!==u?(Ue(),qe()!==u?(r,r=vt(t)):(Qt=r,r=u)):(Qt=r,r=u)):(Qt=r,r=u))),r}function he(){var t,e,n;return t=Qt,(e=be())!==u?(Ue(),function(){var t;e=dr,0===Kt&&Vt(e),46===r.charCodeAt(Qt)?(t=m,Qt++):t=u;var e;return t}()!==u?(Ue(),(n=de())!==u?(t,t=pt(e,n)):(Qt=t,t=u)):(Qt=t,t=u)):(Qt=t,t=u),t===u&&(t=Qt,(e=be())!==u&&(t,e=ht(e)),t=e),t}function de(){var r,t;return r=Qt,(t=function(){var r,t,e,n;if(r=Qt,(t=ge())!==u){for(e=[],n=me();n!==u;)e.push(n),n=me();r,r=mt(t,e)}else Qt=r,r=u;return r}())!==u?(Qt,(dt(t)?u:void 0)!==u?(r,r=yt(t)):(Qt=r,r=u)):(Qt=r,r=u),r}function ye(){var t;return(t=function(){var t,e,n,o,i=function(r){0===Kt&&Vt(r)};t=Qt,i(ir),34===r.charCodeAt(Qt)?(e=d,Qt++):e=u;if(e!==u){if(n=[],i(ar),Q.test(r.charAt(Qt))?(o=r.charAt(Qt),Qt++):o=u,o!==u)for(;o!==u;)n.push(o),i(ar),Q.test(r.charAt(Qt))?(o=r.charAt(Qt),Qt++):o=u;else n=u;n!==u?(i(ir),34===r.charCodeAt(Qt)?(o=d,Qt++):o=u,o!==u?(t,t=bt(n)):(Qt=t,t=u)):(Qt=t,t=u)}else Qt=t,t=u;return t}())===u&&(t=function(){var t,e,n,o,i=function(r){0===Kt&&Vt(r)};t=Qt,i(cr),39===r.charCodeAt(Qt)?(e=y,Qt++):e=u;if(e!==u){if(n=[],i(fr),Z.test(r.charAt(Qt))?(o=r.charAt(Qt),Qt++):o=u,o!==u)for(;o!==u;)n.push(o),i(fr),Z.test(r.charAt(Qt))?(o=r.charAt(Qt),Qt++):o=u;else n=u;n!==u?(i(cr),39===r.charCodeAt(Qt)?(o=y,Qt++):o=u,o!==u?(t,t=bt(n)):(Qt=t,t=u)):(Qt=t,t=u)}else Qt=t,t=u;return t}())===u&&(t=function(){var t,e,n,o,i=function(r){0===Kt&&Vt(r)};t=Qt,i(lr),96===r.charCodeAt(Qt)?(e=b,Qt++):e=u;if(e!==u){if(n=[],i(sr),W.test(r.charAt(Qt))?(o=r.charAt(Qt),Qt++):o=u,o!==u)for(;o!==u;)n.push(o),i(sr),W.test(r.charAt(Qt))?(o=r.charAt(Qt),Qt++):o=u;else n=u;n!==u?(i(lr),96===r.charCodeAt(Qt)?(o=b,Qt++):o=u,o!==u?(t,t=bt(n)):(Qt=t,t=u)):(Qt=t,t=u)}else Qt=t,t=u;return t}()),t}function be(){var r,t;return r=Qt,(t=function(){var r,t,e,n;if(r=Qt,(t=ge())!==u){for(e=[],n=Ae();n!==u;)e.push(n),n=Ae();r,r=mt(t,e)}else Qt=r,r=u;return r}())!==u?(Qt,(dt(t)?u:void 0)!==u?(r,r=gt(t)):(Qt=r,r=u)):(Qt=r,r=u),r}function ge(){var t,e;return e=vr,0===Kt&&Vt(e),K.test(r.charAt(Qt))?(t=r.charAt(Qt),Qt++):t=u,t}function me(){var t,e;return e=pr,0===Kt&&Vt(e),X.test(r.charAt(Qt))?(t=r.charAt(Qt),Qt++):t=u,t}function Ae(){var t,e;return e=hr,0===Kt&&Vt(e),B.test(r.charAt(Qt))?(t=r.charAt(Qt),Qt++):t=u,t}function Ce(){var t;return(t=function(){var r,t;r=Qt,(t=ye())!==u&&(r,t=Et(t));return r=t}())===u&&(t=_e())===u&&(t=function(){var t,e;t=Qt,(e=function(){var t,e,n,o,i;return t=Qt,i=Ar,0===Kt&&Vt(i),r.substr(Qt,4).toLowerCase()===C?(e=r.substr(Qt,4),Qt+=4):e=u,e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?t=e=[e,n]:(Qt=t,t=u)):(Qt=t,t=u),t}())!==u&&(t,e=Ct());(t=e)===u&&(t=Qt,(e=function(){var t,e,n,o;t=Qt,i=Cr,0===Kt&&Vt(i),r.substr(Qt,5).toLowerCase()===_?(e=r.substr(Qt,5),Qt+=5):e=u;var i;e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?t=e=[e,n]:(Qt=t,t=u)):(Qt=t,t=u);return t}())!==u&&(t,e=_t()),t=e);return t}())===u&&(t=function(){var t,e;t=Qt,(e=function(){var t,e,n,o,i;return t=Qt,i=mr,0===Kt&&Vt(i),r.substr(Qt,4).toLowerCase()===A?(e=r.substr(Qt,4),Qt+=4):e=u,e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?t=e=[e,n]:(Qt=t,t=u)):(Qt=t,t=u),t}())!==u&&(t,e=At());return t=e}()),t}function _e(){var r,t;return r=Qt,(t=function(){var r,t,e,n;r=Qt,(t=Ee())!==u&&(e=we())!==u&&(n=Se())!==u?(Ue(),r,r=St(t,e,n)):(Qt=r,r=u);r===u&&(r=Qt,(t=Ee())!==u&&(e=we())!==u?(n=Ue(),r,r=xt(t,e)):(Qt=r,r=u),r===u&&(r=Qt,(t=Ee())!==u&&(e=Se())!==u?(n=Ue(),r,r=Ot(t,e)):(Qt=r,r=u),r===u&&(r=Qt,(t=Ee())!==u?(e=Ue(),r,r=Lt(t)):(Qt=r,r=u))));return r}())!==u&&(r,t=wt(t)),r=t}function Ee(){var r;return(r=xe())===u&&(r=Oe()),r}function we(){var t,e,n,o;return t=Qt,o=dr,0===Kt&&Vt(o),46===r.charCodeAt(Qt)?(e=m,Qt++):e=u,e!==u&&(n=xe())!==u?(t,t=Tt(n)):(Qt=t,t=u),t}function Se(){var t,e,n;return t=Qt,(e=function(){var t,e,n,o=function(r){0===Kt&&Vt(r)};t=Qt,o(br),H.test(r.charAt(Qt))?(e=r.charAt(Qt),Qt++):e=u;e!==u?(o(gr),Y.test(r.charAt(Qt))?(n=r.charAt(Qt),Qt++):n=u,n===u&&(n=null),t,t=Rt(e,n)):(Qt=t,t=u);return t}())!==u&&(n=xe())!==u?(t,t=jt(e,n)):(Qt=t,t=u),t}function xe(){var r,t,e;if(r=Qt,t=[],(e=Oe())!==u)for(;e!==u;)t.push(e),e=Oe();else t=u;return t!==u&&(r,t=kt(t)),r=t}function Oe(){var t,e;return e=yr,0===Kt&&Vt(e),G.test(r.charAt(Qt))?(t=r.charAt(Qt),Qt++):t=u,t}function Le(){var t,e,n,o,i;return t=Qt,i=xr,0===Kt&&Vt(i),r.substr(Qt,2).toLowerCase()===O?(e=r.substr(Qt,2),Qt+=2):e=u,e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?t=e=[e,n]:(Qt=t,t=u)):(Qt=t,t=u),t}function Te(){var t,e,n,o,i;return t=Qt,i=kr,0===Kt&&Vt(i),r.substr(Qt,2).toLowerCase()===R?(e=r.substr(Qt,2),Qt+=2):e=u,e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?(t,t=It()):(Qt=t,t=u)):(Qt=t,t=u),t}function je(){var t,e,n,o,i;return t=Qt,i=Rr,0===Kt&&Vt(i),r.substr(Qt,2).toLowerCase()===D?(e=r.substr(Qt,2),Qt+=2):e=u,e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?(t,t=Nt()):(Qt=t,t=u)):(Qt=t,t=u),t}function ke(){var t,e,n,o,i;return t=Qt,i=Dr,0===Kt&&Vt(i),r.substr(Qt,4).toLowerCase()===P?(e=r.substr(Qt,4),Qt+=4):e=u,e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?(t,t=Ft()):(Qt=t,t=u)):(Qt=t,t=u),t}function Re(){var t,e,n,o,i;return t=Qt,i=Pr,0===Kt&&Vt(i),r.substr(Qt,6).toLowerCase()===I?(e=r.substr(Qt,6),Qt+=6):e=u,e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?(t,t=Mt()):(Qt=t,t=u)):(Qt=t,t=u),t}function De(){var t,e,n,o,i;return t=Qt,i=Ir,0===Kt&&Vt(i),r.substr(Qt,3).toLowerCase()===N?(e=r.substr(Qt,3),Qt+=3):e=u,e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?(t,t=qt()):(Qt=t,t=u)):(Qt=t,t=u),t}function Pe(){var t,e,n,o,i;return t=Qt,i=Nr,0===Kt&&Vt(i),r.substr(Qt,3).toLowerCase()===F?(e=r.substr(Qt,3),Qt+=3):e=u,e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?(t,t=Ut()):(Qt=t,t=u)):(Qt=t,t=u),t}function Ie(){var t,e,n,o,i;return t=Qt,i=Fr,0===Kt&&Vt(i),r.substr(Qt,2).toLowerCase()===M?(e=r.substr(Qt,2),Qt+=2):e=u,e!==u?(n=Qt,Jt(),o=ge(),$t(!0),o===u?n=void 0:(Qt=n,n=u),n!==u?(t,t=zt()):(Qt=t,t=u)):(Qt=t,t=u),t}function Ne(){var t,e;return e=Mr,0===Kt&&Vt(e),44===r.charCodeAt(Qt)?(t=q,Qt++):t=u,t}function Fe(){var t,e;return e=qr,0===Kt&&Vt(e),42===r.charCodeAt(Qt)?(t=g,Qt++):t=u,t}function Me(){var t,e;return e=Ur,0===Kt&&Vt(e),40===r.charCodeAt(Qt)?(t=U,Qt++):t=u,t}function qe(){var t,e;return e=zr,0===Kt&&Vt(e),41===r.charCodeAt(Qt)?(t=z,Qt++):t=u,t}function Ue(){var r,t;for(r=[],t=ze();t!==u;)r.push(t),t=ze();return r}function ze(){var t,e;return e=Qr,0===Kt&&Vt(e),J.test(r.charAt(Qt))?(t=r.charAt(Qt),Qt++):t=u,t}var Qe={AND:!0,ASC:!0,BY:!0,CONTAINS:!0,DESC:!0,EXISTS:!0,FALSE:!0,FROM:!0,GROUP:!0,IN:!0,IS:!0,LIKE:!0,LIMIT:!0,NOT:!0,NULL:!0,OR:!0,ORDER:!0,SELECT:!0,TRUE:!0,WHERE:!0};function Ze(r,t){return{type:"unary_expr",operator:r,expr:t}}function We(r,t,e){return{type:"binary_expr",operator:r,left:t,right:e}}function Ke(r,t){for(var e=[r],n=0;n<t.length;n++)e.push(t[n][3]);return e}function Xe(r,t){for(var e=r,n=0;n<t.length;n++)e=We(t[n][1],e,t[n][3]);return e}if(Jt(),(e=i())!==u&&Qt===r.length)return e;throw e!==u&&Qt<r.length&&Vt({type:"end"}),function(){var t=Wt[0],e=t.pos;return re(t.variants,e<r.length?r.charAt(e):null,e<r.length?Yt(e,e+1):Yt(e,e))}()}Object.defineProperty(t,"__esModule",{value:!0}),t.SyntaxError=n,t.parse=u,t.default=void 0,function(r,t){function e(){this.constructor=r}e.prototype=t.prototype,r.prototype=new e}(n,Error),n.buildMessage=function(r,t){var e={literal:function(r){return'"'+u(r.text)+'"'},class:function(r){var t=r.parts.map(function(r){return Array.isArray(r)?o(r[0])+"-"+o(r[1]):o(r)});return"["+(r.inverted?"^":"")+t+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(r){return r.description},not:function(r){return"not "+i(r.expected)}};function n(r){return r.charCodeAt(0).toString(16).toUpperCase()}function u(r){return r.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(r){return"\\x0"+n(r)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(r){return"\\x"+n(r)})}function o(r){return r.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(r){return"\\x0"+n(r)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(r){return"\\x"+n(r)})}function i(r){return e[r.type](r)}return"Expected "+function(r){var t,e,n=r.map(i);if(n.sort(),n.length>0){for(t=1,e=1;t<n.length;t++)n[t-1]!==n[t]&&(n[e]=n[t],e++);n.length=e}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(r)+" but "+function(r){return r?'"'+u(r)+'"':"end of input"}(t)+" found."};var o={SyntaxError:n,parse:u};t.default=o},function(r,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Transpiler=void 0;var n=e(5),u=e(0);function o(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}var i=function(){function r(){!function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r)}var t,e,i;return t=r,i=[{key:"_getColumnReferences",value:function(r){var t=new Set;return r.forEach(function(r){if("column_ref"!==r.type)throw new Error('Expected "'.concat(r,'"" to be a column_ref'));t.add(r.column)}),t}},{key:"_augmentWhere",value:function(r,t){var e=t.entries().next().value[0];!function r(n){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(n){if("binary_expr"===n.type)if("AND"===n.operator||"OR"===n.operator)r(n.left,n.operator),r(n.right,n.operator);else if("="===n.operator){if(n.left.field||(n.left.field=n.left.column,n.left.column=e),!t.has(n.left.column))throw Error('Column "'.concat(n.left.column,'" was not specified in the Columns clause'));var o=n.left.column,i=n.left.field;if("string"!==n.right.type&&"number"!==n.right.type)throw Error("Expected a string or number, but found ".concat(n.right.type," instead"));var a=n.right.value;n.selector={table:o,selector:"[".concat(i,'="').concat(a,'"]')},n.type="selector",delete n.left,delete n.right,delete n.operator}n.parent=u}}(r)}},{key:"_constructSelectors",value:function(r,t){if(r){var e=!1,n=!1;!function r(u){if("selector"===u.type){var o=t[u.selector.table];if(n)return o.push(o[o.length-1]),n=!1,void(o[o.length-2]+=u.selector.selector);e&&(""!==o[o.length-1]&&o.push(""),e=!1),o[o.length-1]+=u.selector.selector}if("binary_expr"===u.type){var i=u.left,a=u.right;"AND"===u.operator?(r(i),r(a)):"OR"===u.operator&&("AND"===u.parent&&(n=!0),r(i),"AND"!==u.parent&&(e=!0),r(a))}}(r)}}},{key:"_compileSelectors",value:function(r,t){t="*"===t?"":t+" ";var e=[];for(var n in r){for(var u="",o=0;o<r[n].length;o++)u+=t+n+r[n][o],o<r[n].length-1&&(u+=", ");e.push(u)}return e.join(", ")}},{key:"transpile",value:function(t){var e=r._getColumnReferences(t.columns),o=t.from.table;r._augmentWhere(t.where,e);var i={};e.forEach(function(r){i[r]=[""]}),r._constructSelectors(t.where,i);var a=[r._compileSelectors(i,o)];return a.push(n.QueryEngine.getEngine()),t.limit&&a.push(u.Directives.limiter.bind(null,t.limit.value)),a}}],(e=null)&&o(t.prototype,e),i&&o(t,i),r}();t.Transpiler=i},function(r,t,e){"use strict";function n(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.QueryEngine=void 0;var u=function(){function r(){!function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r)}var t,e,u;return t=r,u=[{key:"getEngine",value:function(){return r._querySelector}},{key:"setEngine",value:function(t){r._querySelector=t}},{key:"useDefault",value:function(){r._querySelector=r.defaultQuerySelector}},{key:"defaultQuerySelector",value:function(r){return Array.from(document.querySelectorAll(r))}}],(e=null)&&n(t.prototype,e),u&&n(t,u),r}();t.QueryEngine=u,u._querySelector=u.defaultQuerySelector}])});